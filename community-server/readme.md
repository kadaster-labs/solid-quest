Inspired by:
https://github.com/CommunitySolidServer/Recipes/tree/main/mashlib